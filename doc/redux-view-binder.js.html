<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>redux-view-binder.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ReduxViewBinder.html">ReduxViewBinder</a><ul class='methods'><li data-type='method'><a href="ReduxViewBinder.html#bind">bind</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">redux-view-binder.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** (c) 2017 Objective Systems Integrators, Inc. (MYCOM OSI) All Rights Reserved.
 *
 *   ReduxViewBinder
 */
export class ReduxViewBinder {
    /**
     *  Creates a new ReduxViewBinder
     *
     * @param {Object} store - The Redux store.
     */
    constructor(store){
        this._store = store;
    }

    /**
    * Specifies which part of the Redux state object is observed. When this
    * sub-part of the Redux state changes then the onChange method is called.
    * The equality is tested using JSON.stringify.
    *
    * @callback watchCb
    * @param {Object} state - The current Redux state.
    * @Returns {Object} the sub-part of the Redux state object that should be observed.
    *
    */

    /**
    * Specifies which part of the Redux state object is passed to the onChange method. It is especialy useful to pass a higher level sub-part of the Redux state object that the one watched.
    *
    * @callback filterCb
    * @param {Object} state - The current Redux state.
    * @Returns {Object} the sub-part of the Redux state object that should be observed.
    *
    */

    /**
    * The Reduc dispatch function.
    *
    * @callback dispatchCb
    * @param {Object} action - The action to dispatch.
    *
    */

    /**
    * Specifies which part of the Redux state object is passed to the onChange method.
    *
    * @callback onChangeCb
    * @param {Object} filteredModel - The filtered Redux state object.
    * @param {dispatchCb} dispatch - The dispatch function.
    * @param {Object} [view] - The view bound.
    *
    */

    /**
    * Use this method to bind the view to model changes. The view can be passed as parameter or using side effects inside the onChange method.
    *
    * @param {watchCb} watch - The watch function.
    * @param {onChangeCb} onChange - The onChange function.
    * @param {Object} [view] - The view to be bound to model changes.
    * @param {filterCb} [filter] - The filter function.
    *
    */
    bind(watch, onChange, view, filter){
        let currentState;

        function handleChange() {
            let model = this._store.getState();
            let nextState = watch(model);
            if (!this._jsonEqual(nextState, currentState)) {
                currentState = nextState;
                let filteredModel = currentState;
                if (filter)
                filteredModel = filter(model);
                onChange(filteredModel, this._store.dispatch, view);
            }
        }

        let fn = handleChange.bind(this);
        // subscribing to futur changes of Redux state
        let unsubscribe = this._store.subscribe(fn);
        //Force first execution of handleChange
        fn();
        return unsubscribe;
    }

    _jsonEqual(a,b) {
        return JSON.stringify(a) === JSON.stringify(b);
    }
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue May 09 2017 12:13:13 GMT+0200 (CEST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
